# Finom Desktop SDK Example

Reference implementation for integrating Boxo Desktop SDK into Finom Desktop App.

## Overview

This example demonstrates how to integrate `boxo-desktop-host-sdk` into a Desktop App to host miniapps (eSIM finom desktop miniapp).

## Quick Start

```bash
npm install
npm start
```

App runs on `http://localhost:3001` and expects miniapp on `http://localhost:3000`.

## Key Integration Steps

### 1. Install SDK

```bash
npm install boxo-desktop-host-sdk
```

### 2. Initialize SDK

```typescript
import { BoxoDesktopHostSDK } from 'boxo-desktop-host-sdk';

const config = {
  clientId: '602248',  // From Boxo Platform
  appId: 'app29296',    // From Boxo Platform  
  baseUrl: 'https://dashboard.appboxo.com/api/v1',
  debug: true
};

const sdk = new BoxoDesktopHostSDK(config);
```

### 3. Set Auth Code

```typescript
// Get auth_code from your Desktop App backend
const authCode = await getAuthCodeFromBackend();
sdk.setAuthCode(authCode);
```

### 4. Initialize with iframe

```typescript
const iframe = document.getElementById('miniapp-iframe');
sdk.setIframe(iframe);
sdk.initialize();
```

## Authentication Flow

1. Miniapp calls `appboxo.login()`
2. Desktop SDK receives `AppBoxoWebAppLogin` event
3. SDK uses auth_code to call Boxo Platform `/authorize/`
4. SDK returns tokens to miniapp
5. Miniapp stores tokens in localStorage

## Event Handling

SDK automatically handles these events:
- `AppBoxoWebAppLogin` - Authentication
- `AppBoxoWebAppPay` - Payment processing  
- `AppBoxoWebAppCustomEvent` - Custom events

Register custom handlers:

```typescript
sdk.onEvent('your-event-type', async (type, payload) => {
  // Handle custom event
  return { success: true };
});
```

## Project Structure

```
src/
├── App.tsx              # Main app component
├── App.css              # Styles
└── index.tsx            # Entry point
```

## Configuration

Update these values in `App.tsx`:

- `clientId`: Your Desktop App identifier from Boxo Platform
- `appId`: Miniapp identifier
- `auth_code`: Test auth code from Tima (use backend in production)
- `iframe.src`: Your miniapp URL

## Production Setup

For production, replace test auth code with real backend integration:

```typescript
// Option 1: Get from backend and set
const authCode = await fetch('/api/auth-code').then(r => r.json());
sdk.setAuthCode(authCode);

// Option 2: Use callback
const sdk = new BoxoDesktopHostSDK({
  ...config,
  onGetAuthCode: async () => {
    const response = await fetch('/api/auth-code');
    const data = await response.json();
    return data.auth_code;
  }
});
```

## Development

```bash
# Install dependencies
npm install

# Start dev server
npm start

# Build for production
npm run build
```

## Notes

- This example demonstrates the core SDK integration pattern
- Production implementation should connect to real Desktop App backend
- Auth code should be generated by your backend based on user session
# b-example
